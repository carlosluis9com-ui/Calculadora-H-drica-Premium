<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Dotaciones & Proyecciones</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <!-- Fluid Background -->
    <div class="bg-shape bg-shape-1"></div>
    <div class="bg-shape bg-shape-2"></div>
    <div class="bg-shape bg-shape-3"></div>

    <div class="container glass-panel">
        <header>
            <div class="theme-switcher">
                <div class="theme-toggle">‚ú®</div>
                <div class="theme-menu">
                    <button class="theme-btn" onclick="setTheme('claro')" id="btn-claro">‚òÄÔ∏è Claro</button>
                    <button class="theme-btn" onclick="setTheme('oscuro')" id="btn-oscuro">üåô Mate</button>
                    <button class="theme-btn active" onclick="setTheme('tokio')" id="btn-tokio">üå∏ Tokio</button>
                </div>
            </div>
            <h1>üíß Calculadora H√≠drica Premium</h1>
            <p>Proyecci√≥n Poblacional & Dotaciones (Gaceta 4044)</p>
        </header>

        <div class="nav-tabs">
            <div class="nav-item active" onclick="openTab('proyeccion')">üìà Proyecciones</div>
            <div class="nav-item" onclick="openTab('percapita')">üë• Per C√°pita</div>
            <div class="nav-item" onclick="openTab('multifamiliar')">üè¢ Multifamiliar</div>
            <div class="nav-item" onclick="openTab('bifamiliar')">üè° Bifamiliar</div>
            <div class="nav-item" onclick="openTab('unifamiliar')">üè† Unifamiliar</div>
            <div class="nav-item" onclick="openTab('otros')">üè• Otros Usos</div>
            <div class="nav-item" onclick="openTab('reporte')">üìã Reporte</div>
        </div>

        <!-- TAB 1: PROYECCIONES (INDEPENDIENTE) -->
        <div id="proyeccion" class="section active fade-in">
            <h2>üìà Proyecci√≥n de Poblaci√≥n</h2>
            <div class="info-text">Calcula el crecimiento poblacional proyectado con tres m√©todos matem√°ticos y
                gr√°ficos. Este c√°lculo es completamente independiente a las otras pesta√±as de Dotaciones.</div>

            <div class="card glass-panel-inner mt-4">
                <div class="form-group row">
                    <div class="col">
                        <label>A√±o Primer Censo</label>
                        <input type="number" id="t1" placeholder="Ej: 2005">
                    </div>
                    <div class="col">
                        <label>Poblaci√≥n Primer Censo</label>
                        <input type="number" id="p1" placeholder="Ej: 5000">
                    </div>
                </div>

                <div class="form-group row mt-3">
                    <div class="col">
                        <label>A√±o √öltimo Censo</label>
                        <input type="number" id="t2" placeholder="Ej: 2015">
                    </div>
                    <div class="col">
                        <label>Poblaci√≥n √öltimo Censo</label>
                        <input type="number" id="p2" placeholder="Ej: 8000">
                    </div>
                </div>

                <div class="form-group row mt-3">
                    <div class="col">
                        <label>A√±o a Proyectar</label>
                        <input type="number" id="ano-proyectar" placeholder="Ej: 2040">
                    </div>
                    <div class="col">
                        <label>M√©todo de Enfoque</label>
                        <select id="metodo-proyeccion">
                            <option value="geometrico">Geom√©trico (Recomendado)</option>
                            <option value="aritmetico">Aritm√©tico</option>
                            <option value="logaritmico">Exponencial / Logar√≠tmico</option>
                        </select>
                    </div>
                </div>

                <button class="btn-primary mt-4" onclick="calcularProyeccion()">Calcular Proyecciones y
                    Graficar</button>
            </div>

            <div id="resultados-proyeccion" class="card glass-panel-inner mt-4 fade-in" style="display: none;">
                <h3>üìä Resultados</h3>
                <div class="results-grid">
                    <div class="result-box" id="box-aritmetico">
                        <h4>Aritm√©tico</h4>
                        <div class="value" id="res-aritmetico">--</div>
                        <div class="sub-value">hab.</div>
                    </div>
                    <div class="result-box glow" id="box-geometrico">
                        <h4>Geom√©trico</h4>
                        <div class="value" id="res-geometrico">--</div>
                        <div class="sub-value">hab.</div>
                    </div>
                    <div class="result-box" id="box-logaritmico">
                        <h4>Exp / Log</h4>
                        <div class="value" id="res-exponencial">--</div>
                        <div class="sub-value">hab.</div>
                    </div>
                </div>

                <div class="chart-container mt-4">
                    <canvas id="projectionChart" width="400" height="200"></canvas>
                </div>

                <button class="btn-primary mt-4" id="btn-add-proy-reporte" onclick="agregarProyeccionAlReporte()"
                    style="background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%); width: 100%;">‚ûï
                    Agregar este Resumen al Reporte</button>
            </div>
        </div>

        <!-- TAB EXTRA: PER C√ÅPITA -->
        <div id="percapita" class="section fade-in" style="display: none;">
            <h2>üë• M√©todo Per C√°pita</h2>
            <div class="info-text">C√°lculo basado en la poblaci√≥n proyectada total de una zona.</div>

            <div class="card glass-panel-inner mt-4">
                <div class="form-group row">
                    <div class="col">
                        <label>Poblaci√≥n Base (hab)</label>
                        <input type="number" id="poblacion-base" placeholder="Ej: 5000">
                    </div>
                    <div class="col">
                        <label>Dotaci√≥n (Lts/hab/d√≠a)</label>
                        <input type="number" id="dotacion-per-capita" placeholder="Ej: 200">
                        <small style="margin-top: 5px;"><a href="#" id="btn-auto-norma"
                                style="color:var(--accent-cyan); text-decoration:none; font-weight: 600;">ü™Ñ
                                Auto-asignar seg√∫n Norma</a></small>
                    </div>
                </div>
            </div>

            <button class="btn-primary mt-4" onclick="calcularPerCapita()">Calcular Demanda Per C√°pita</button>
        </div>

        <!-- TAB 2: MULTIFAMILIAR (GACETA 4044) -->
        <div id="multifamiliar" class="section fade-in" style="display: none;">
            <h2>üè¢ Viviendas Multifamiliares (Edificios)</h2>
            <div class="info-text">Art√≠culo 109, Literales B y C. Gaceta Oficial 4044.</div>

            <div class="sub-tabs mt-4">
                <button class="sub-btn active" onclick="openSubTab('multi-exacto', this)">‚úÖ M√©todo Exacto
                    (Habitaciones)</button>
                <button class="sub-btn" onclick="openSubTab('multi-estimado', this)">üìê M√©todo Estimado (Factor
                    K)</button>
            </div>

            <div id="multi-exacto" class="sub-content active fade-in">
                <div class="info-text accent-bg">Usar cuando se conoce la distribuci√≥n arquitect√≥nica (N¬∞ de
                    habitaciones) mediante la Tabla 8.</div>

                <div class="card glass-panel-inner mt-3">
                    <div class="form-group row">
                        <div class="col">
                            <label>1. N¬∞ de Parcelas:</label>
                            <input type="number" id="me_parcelas" value="1" placeholder="Ej: 6">
                        </div>
                        <div class="col">
                            <label>2. √Årea de Parcela (m¬≤):</label>
                            <input type="number" id="me_area" placeholder="Ej: 3800">
                        </div>
                    </div>
                    <div class="form-group row mt-3">
                        <div class="col">
                            <label>3. Edificios por Parcela:</label>
                            <input type="number" id="me_edificios" placeholder="Ej: 4">
                        </div>
                        <div class="col">
                            <label>4. Pisos por Edificio:</label>
                            <input type="number" id="me_pisos" placeholder="Ej: 5">
                        </div>
                    </div>
                    <div class="form-group row mt-3">
                        <div class="col">
                            <label>5. Aptos. por Piso:</label>
                            <input type="number" id="me_aptos" placeholder="Ej: 5">
                        </div>
                        <div class="col">
                            <label>6. Habs. por Apto:</label>
                            <input type="number" id="me_habs" placeholder="Ej: 3">
                        </div>
                    </div>
                </div>
            </div>

            <div id="multi-estimado" class="sub-content fade-in" style="display: none;">
                <div class="info-text accent-bg">
                    <strong>Factor K para Macroproyectos:</strong><br>
                    1. (Construcci√≥n / Parcela) √ó 100 = <strong>% Const.</strong><br>
                    2. (% Const. / 10) = <strong>Factor K</strong><br>
                    3. Parcela √ó Factor K = <strong>Dotaci√≥n</strong>
                </div>

                <div class="card glass-panel-inner mt-3">
                    <div class="form-group row">
                        <div class="col">
                            <label>1. √Årea Total de la Parcela (m¬≤):</label>
                            <input type="number" id="ms_area_parcela" placeholder="√Årea del terreno (Ej: 4000)">
                        </div>
                        <div class="col">
                            <label>2. √Årea Bruta de Construcci√≥n (m¬≤):</label>
                            <input type="number" id="ms_area_const"
                                placeholder="Construcci√≥n total cubierta (Ej: 1700)">
                        </div>
                    </div>
                    <div class="form-group mt-3">
                        <label>3. Cantidad de Parcelas (Lotes Iguales):</label>
                        <input type="number" id="ms_cant_parcelas" value="1" placeholder="Multiplicador (Ej: 8)">
                    </div>
                </div>
            </div>

            <div class="card glass-panel-inner mt-4">
                <label>üå≥ Porcentaje de √Årea Verde / Jardines (%):</label>
                <input type="number" id="multi_jardin" placeholder="Ej: 10">
                <div class="info-text mt-2">Corresponde a la dotaci√≥n de riego (2 L/dia/m¬≤) en base al √°rea de
                    parcela.
                </div>
            </div>

            <button class="btn-primary mt-4" onclick="calcularMultifamiliar()">Calcular Edificaci√≥n</button>
        </div>

        <!-- TAB 3: BIFAMILIAR -->
        <div id="bifamiliar" class="section fade-in" style="display: none;">
            <h2>üè° Viviendas Bifamiliares</h2>
            <div class="info-text">Art√≠culo 109. Literales A y B: "Para la planta baja se aplica el √°rea de parcela.
                Para la superior, por n√∫mero de cuartos".</div>

            <div class="card glass-panel-inner mt-4">
                <div class="form-group">
                    <label>1. √Årea Total de la Parcela (m¬≤) [PB]:</label>
                    <input type="number" id="bi_area" placeholder="Terreno total (Ej: 300)">
                </div>
                <div class="form-group mt-3">
                    <label>2. Habs. en Planta Alta [PA]:</label>
                    <input type="number" id="bi_habs" placeholder="N¬∞ Dormitorios (Ej: 4)">
                </div>
                <div class="form-group row mt-3">
                    <div class="col">
                        <label>3. Cantidad de Bifamiliares:</label>
                        <input type="number" id="bi_cantidad" value="1" placeholder="N¬∞ de Unidades (Ej: 10)">
                    </div>
                    <div class="col">
                        <label>üå≥ Porcentaje de Jard√≠n (%):</label>
                        <input type="number" id="bi_jardin" placeholder="Ej: 10">
                    </div>
                </div>
            </div>

            <button class="btn-primary mt-4" onclick="calcularBifamiliar()">Calcular Vivienda Bifamiliar</button>
        </div>

        <!-- TAB 4: UNIFAMILIAR -->
        <div id="unifamiliar" class="section fade-in" style="display: none;">
            <h2>üè† Vivienda Unifamiliar</h2>
            <div class="info-text">Art√≠culo 109, Literal A. Rango escalonado mediante Tabla 7. (Ya incluye √°reas
                verdes).</div>

            <div class="card glass-panel-inner mt-4">
                <div class="form-group">
                    <label>1. √Årea Total de la Parcela (m¬≤):</label>
                    <input type="number" id="uni_area" placeholder="Medida del Terreno (Ej: 250)">
                </div>
                <div class="form-group mt-3">
                    <label>2. N√∫mero de Parcelas Iguales (Casa):</label>
                    <input type="number" id="uni_cant" value="1">
                </div>
            </div>

            <button class="btn-primary mt-4" onclick="calcularUnifamiliar()">Calcular Conjunto / Casas</button>
        </div>

        <!-- TAB 5: OTROS USOS -->
        <div id="otros" class="section fade-in" style="display: none;">
            <h2>üè• Servicios, Educaci√≥n y Comercio</h2>
            <div class="info-text">Art√≠culo 110. Dotaciones espec√≠ficas por naturaleza de ocupaci√≥n.</div>

            <div class="card glass-panel-inner mt-4">
                <div class="form-group">
                    <label>Seleccione el Tipo (Destino):</label>
                    <select id="otros_tipo">
                        <optgroup label="Art. 110 - Asistenciales">
                            <option value="hosp_cama" data-dot="800" data-unit="Camas">Hospitalizaci√≥n (800
                                L/d/cama)
                            </option>
                            <option value="hosp_cons" data-dot="500" data-unit="Consultorios">Consulta Externa (500
                                L/d/consl.)</option>
                            <option value="dental" data-dot="1000" data-unit="Unidades Dent.">Cl√≠nicas Dentales
                                (1000
                                L/d/unidad)</option>
                        </optgroup>
                        <optgroup label="Art. 110 - Educacionales">
                            <option value="edu_ext" data-dot="40" data-unit="Alumnos">Alumnado Externo (40
                                L/d/alum.)
                            </option>
                            <option value="edu_semi" data-dot="70" data-unit="Alumnos">Alumnado Semi-interno (70
                                L/d/alum.)</option>
                            <option value="edu_int" data-dot="200" data-unit="Alumnos">Alumnado Interno/Residente
                                (200
                                L/d/alum.)</option>
                            <option value="edu_pers_res" data-dot="200" data-unit="Personas">Personal Residente (200
                                L/d/pers.)</option>
                            <option value="edu_pers_no_res" data-dot="50" data-unit="Personas">Personal No Residente
                                (50
                                L/d/pers.)</option>
                        </optgroup>
                        <optgroup label="Art. 110 - Instituciones Varias">
                            <option value="cuarteles" data-dot="300" data-unit="Personas">Cuarteles (300 L/d/pers.)
                            </option>
                            <option value="carceles" data-dot="200" data-unit="Personas">C√°rceles (200 L/d/pers.)
                            </option>
                            <option value="iglesias" data-dot="0.5" data-unit="m¬≤ Neto">Iglesias (0.5 L/d/m¬≤)
                            </option>
                            <option value="oficinas_pub" data-dot="6" data-unit="m¬≤ Local">Oficinas P√∫blicas/Grales
                                (6
                                L/d/m¬≤)</option>
                        </optgroup>
                        <optgroup label="Art. 111 - Comercios y Anexos">
                            <option value="deposito" data-dot="0.5" data-unit="m¬≤ √ötil">Dep√≥sitos/Almacenes (0.5
                                L/d/m¬≤
                                por turno)</option>
                            <option value="mercado" data-dot="15" data-unit="m¬≤ Ventas">Mercados (15 L/d/m¬≤)
                            </option>
                            <option value="carniceria" data-dot="25" data-unit="m¬≤ Ventas">Carnicer√≠as/Pescader√≠as
                                (25
                                L/d/m¬≤)</option>
                            <option value="super" data-dot="20" data-unit="m¬≤ Ventas">Supermercados/Tiendas (20
                                L/d/m¬≤)
                            </option>
                            <option value="rest" data-dot="50" data-unit="m¬≤ √ötil">Restaurantes (50 L/d/m¬≤)</option>
                            <option value="bar" data-dot="60" data-unit="m¬≤ √ötil">Bares/Fuentes soda (60 L/d/m¬≤)
                            </option>
                            <option value="cc" data-dot="10" data-unit="m¬≤ Bruto">Centros Comerciales (10 L/d/m¬≤ m.
                                bruto)</option>
                            <option value="hotel" data-dot="500" data-unit="Dormitorios">Hoteles/Moteles (500
                                L/d/dorm.)
                            </option>
                            <option value="pension" data-dot="350" data-unit="Dormitorios">Pensiones (350 L/d/dorm.)
                            </option>
                            <option value="hospedaje" data-dot="25" data-unit="m¬≤ Dormitorios">Hospedajes Generales
                                (25
                                L/d/m¬≤)</option>
                            <option value="lavanderia_ropa" data-dot="40" data-unit="Kg Ropa">Lavander√≠as Generales
                                (40
                                L/d/kilo)</option>
                            <option value="lavanderia_seco" data-dot="30" data-unit="Kg Ropa">Lavander√≠as al Seco
                                (30
                                L/d/kilo)</option>
                            <option value="estacionamiento" data-dot="2" data-unit="m¬≤ Cubierto">Estacionamientos
                                Cubiertos (2 L/d/m¬≤)</option>
                            <option value="ob_bomba" data-dot="300" data-unit="Bombas">Bombas de Gasolina (300
                                L/d/bomba)</option>
                            <option value="lavado_man" data-dot="8000" data-unit="Equipos">Lavado Veh√≠culos Manual
                                (8000
                                L/d/eq.)</option>
                            <option value="lavado_auto" data-dot="12800" data-unit="Equipos">Lavado Veh√≠culos
                                Autom√°tico
                                (12800 L/d/eq.)</option>
                        </optgroup>
                        <optgroup label="Art. 112 - Industrias">
                            <option value="ind_trab" data-dot="80" data-unit="Trabajadores">Personal Industrial (80
                                L/d
                                por trabajador/turno)</option>
                        </optgroup>
                        <optgroup label="Tabla 9 - Recreacional y Deportivo">
                            <option value="cines" data-dot="3" data-unit="Asientos">Cines/Teatros/Auditorios (3
                                L/d/asiento)</option>
                            <option value="estadios" data-dot="3" data-unit="Espectadores">Estadios/Circos/Plaza
                                Toros
                                (3 L/d/espectador)</option>
                            <option value="cabaret" data-dot="30" data-unit="m¬≤ Neto">Discotecas/Salas Baile (30
                                L/d/m¬≤)
                            </option>
                            <option value="parque" data-dot="0.25" data-unit="m¬≤">Parques (0.25 L/d/m¬≤)</option>
                            <option value="piscina_re" data-dot="10" data-unit="m¬≤ Proy. Horiz.">Piscinas
                                c/recirculaci√≥n (10 L/d/m¬≤)</option>
                            <option value="piscina_no" data-dot="25" data-unit="m¬≤ Proy. Horiz.">Piscinas
                                s/recirculaci√≥n (25 L/d/m¬≤)</option>
                            <option value="piscina_flujo" data-dot="125" data-unit="m¬≤ Proy. Horiz.">Piscinas
                                c/flujo
                                continuo (125 L/d/m¬≤)</option>
                            <option value="balneario" data-dot="50" data-unit="Usuarios">Balnearios (50 L/d/usuario)
                            </option>
                            <option value="gimnasio" data-dot="10" data-unit="m¬≤ Neto">Gimnasios (10 L/d/m¬≤)
                            </option>
                            <option value="vestuarios" data-dot="30" data-unit="m¬≤ Proy. Horiz.">Vestuarios Piscina
                                (30
                                L/d/m¬≤ piscina)</option>
                        </optgroup>
                        <optgroup label="Tabla 10 - Animales (Granjas/Alojamientos)">
                            <option value="lechero" data-dot="120" data-unit="Animales">Ganado Lechero (120
                                L/d/animal)
                            </option>
                            <option value="bovino" data-dot="40" data-unit="Animales">Bovinos / Equinos (40
                                L/d/animal)
                            </option>
                            <option value="ovino" data-dot="10" data-unit="Animales">Ovinos / Porc. Rejilla (10
                                L/d/animal)</option>
                            <option value="porcino_norm" data-dot="30" data-unit="Animales">Porcinos Normal (10-30
                                L/d/animal)</option>
                            <option value="aves" data-dot="20" data-unit="Cientos (Lotes de 100)">Aves (20 L/d por
                                cada
                                100 aves)</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group row mt-3">
                    <div class="col">
                        <label id="label_otros_val1">Cantidad M√≥dulo:</label>
                        <input type="number" id="otros_val1" placeholder="Alumnos / Camas / m¬≤ / Personas">
                    </div>
                    <div class="col">
                        <label>√Årea Total de Parcela (m¬≤):</label>
                        <input type="number" id="otros_area" placeholder="P/Jardines (Ej: 1000)">
                    </div>
                </div>
                <div class="form-group row mt-3">
                    <div class="col">
                        <label>Cantidad de Edificaciones de este Tipo:</label>
                        <input type="number" id="otros_cant" value="1">
                    </div>
                    <div class="col">
                        <label>üå≥ Porcentaje de Jardines (%):</label>
                        <input type="number" id="otros_jardin" placeholder="Ej: 15">
                    </div>
                </div>
            </div>

            <button class="btn-primary mt-4" onclick="calcularOtros()">Calcular Dotaci√≥n Especial</button>
        </div>

        <!-- TAB 6: REPORTE -->
        <div id="reporte" class="section fade-in" style="display: none;">
            <h2>üìã Reporte y Sumatoria Total</h2>
            <div class="info-text">Resumen de todas las dotaciones calculadas. El sistema sumar√° autom√°ticamente el
                Gran
                Total para hallar el Caudal Medio del macro-proyecto completo.</div>

            <!-- Contenedor Resumen de Proyecci√≥n -->
            <div id="reporte-proyeccion-container" class="card glass-panel-inner mt-4" style="display: none;">
                <h3
                    style="color: var(--accent-purple); border-bottom: 1px solid var(--glass-border); padding-bottom: 10px; margin-bottom: 15px;">
                    üìä Resumen de Proyecci√≥n Poblacional</h3>
                <p style="margin-bottom: 8px;"><strong>üìö Censos Base:</strong> <span id="rep-proy-base"
                        style="color: var(--text-secondary);"></span></p>
                <p style="margin-bottom: 8px;"><strong>üîÆ Proyecci√≥n al <span id="rep-proy-tf"></span>
                        (Resultado):</strong> <span id="rep-proy-resultado" class="res-highlight"
                        style="font-size: 1.2em;"></span></p>
                <p style="margin-bottom: 8px;"><strong>üìê M√©todo Seleccionado:</strong> <span id="rep-proy-metodo"
                        style="color: var(--text-secondary);"></span></p>

                <div class="chart-container mt-4" style="padding: 10px; text-align: center;">
                    <img id="rep-proy-chart" src="" style="max-width: 100%; height: auto; border-radius: 8px;">
                </div>

                <button class="btn-primary mt-3" onclick="eliminarProyeccionReporte()"
                    style="background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239, 68, 68, 0.4); color: #fca5a5; padding: 6px 15px; font-size: 0.9rem; box-shadow: none;">‚úï
                    Remover Proyecci√≥n del Reporte</button>
            </div>

            <div class="card glass-panel-inner mt-4">
                <div style="overflow-x: auto;">
                    <table
                        style="width: 100%; border-collapse: collapse; color: var(--text-primary); min-width: 600px;">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--glass-border);">
                                <th style="padding: 12px; text-align: left; width: 50%;">Descripci√≥n y Normativa
                                </th>
                                <th style="padding: 12px; text-align: right;">Dotaci√≥n (L/d√≠a)</th>
                                <th style="padding: 12px; text-align: right;">Qmed (L/s)</th>
                                <th style="padding: 12px; text-align: center;">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="tabla-reporte">
                            <!-- El JS inyectar√° categor√≠as y filas din√°micamente -->
                        </tbody>
                        <tfoot>
                            <tr
                                style="border-top: 2px solid var(--accent-cyan); font-weight: bold; background: rgba(6, 182, 212, 0.1);">
                                <td style="padding: 15px 12px; text-align: right; color: var(--accent-cyan);">GRAN
                                    TOTAL
                                    (Caudal Medio):</td>
                                <td id="gran-total-ld"
                                    style="padding: 15px 12px; text-align: right; color: var(--accent-cyan); font-size: 1.2rem;">
                                    0.00</td>
                                <td id="gran-total-ls"
                                    style="padding: 15px 12px; text-align: right; color: var(--accent-cyan); font-size: 1.2rem;">
                                    0.00</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="mt-4" style="text-align: right; display: flex; justify-content: flex-end; gap: 10px;">
                    <button class="btn-primary" onclick="limpiarReporte()"
                        style="width: auto; padding: 12px 20px; background: rgba(239, 68, 68, 0.2); border: 1px solid rgba(239,68,68,0.5); color: #fca5a5; box-shadow: none;">üóëÔ∏è
                        Limpiar Data</button>
                    <button class="btn-primary" onclick="imprimirReporte()" style="width: auto; padding: 12px 25px;">üñ®Ô∏è
                        Imprimir Resumen PDF</button>
                </div>
            </div>
        </div>

    </div>

    <!-- PANEL DE RESULTADOS FLOTANTE (Movido fuera del .container para evitar cortes) -->
    <div id="resultado-panel" class="result-floating fade-in">
        <div class="header-res">
            <h3>üíß RESULTADO DE DEMANDA</h3>
            <span class="close-res" onclick="cerrarResultados()">√ó</span>
        </div>

        <div class="res-body">
            <div class="res-value" id="res_dia">0 L/d√≠a</div>
            <div class="res-secondary" id="res_seg">0.00 L/s (Qm)</div>
            <div class="res-breakdown" id="res_detalle">...</div>
            <button id="btn-add-reporte" class="btn-primary mt-4" onclick="abrirModalEdicion()">‚ûï Agregar al Reporte
                General</button>
        </div>
    </div>

    <!-- MODAL DE EDICI√ìN PRE-GUARDA -->
    <div id="edit-modal" class="result-floating fade-in"
        style="display: none; bottom: 50%; transform: translate(-50%, 50%); z-index: 1050;">
        <div class="header-res" style="background: var(--accent-purple); border-bottom: none;">
            <h3 style="color: white;">‚úèÔ∏è Confirmar Datos del Reporte</h3>
            <span class="close-res" onclick="cerrarModalEdicion()">√ó</span>
        </div>
        <div class="res-body" style="padding: 20px;">
            <div class="form-group" style="text-align: left;">
                <label style="color: var(--text-primary); margin-bottom: 8px;">T√≠tulo / Descripci√≥n de la
                    Edificaci√≥n:</label>
                <input type="text" id="edit-titulo"
                    style="background: var(--input-bg); color: var(--text-primary); border: 1px solid var(--accent-purple);"
                    value="">
            </div>

            <div class="form-group" style="text-align: left; margin-top: 15px;">
                <label style="color: var(--text-primary); margin-bottom: 8px;">Normativa Aplicada
                    (Autom√°tica):</label>
                <textarea id="edit-norma" rows="2"
                    style="width: 100%; padding: 12px; background: rgba(0,0,0,0.2); border: 1px solid var(--glass-border); border-radius: 8px; color: var(--text-secondary); font-family: inherit; resize: none;"
                    readonly></textarea>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-primary" onclick="cerrarModalEdicion()"
                    style="background: transparent; border: 1px solid var(--glass-border); color: var(--text-primary); box-shadow: none;">Cancelar</button>
                <button class="btn-primary" onclick="guardarAlReporteDesdeModal()"
                    style="background: linear-gradient(135deg, var(--accent-purple) 0%, var(--accent-blue) 100%);">üíæ
                    Guardar Cambios</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>